---
title: "Regression Models - Project"
author: "justmzen"
date: "8/28/2020"
output: pdf_document
---

# Executive summary

The aim of the following study is to evaluate the relationship among many variables and miles per gallon (mpg) as the outcome. The main questions are:
- Is an automatic or manual transmission better for mtcars?
- Quantify the mtcars difference between automatic and manual transmissions.

# Data loading and manipulation

```{r, echo = TRUE, message = FALSE}
library('ggplot2')
library('datasets'); data('mtcars')
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am) <- c('Automatic', 'Manual')
```

# Exploratory data analysis

For details on the data set see Appendix A.  
For graphs on interesting variables see Appendix B.  

The data set has 32 observations and 11 variables. The relevant variables are mpg (outcome) and am (asked regressor). The plot in Appendix B shows that there is a possible relationship between the two variables: the manual transmission has a higher mpg compared to the automatic one.  

A t-test could be performed to evaluate the difference of the mean value of the two groups. The formula option in the r function "t-test" will divide the data set into the two groups.

```{r, echo = TRUE}
tTest1 <- t.test(formula = mpg ~ am, data = mtcars)
tTest1$p.value
```

The null hypothesis is that the two groups are similar. Since the p-value is less than 0.05, it is unlikely that the two groups differ just by chance. Hence the null hypothesis is rejected and the alternative hypothesis accepted (transmission influences mpg).

# Model selection

## Linear model based on transmission

The t-test proved that there is a relationship between mpg and am. The first attempt will be modeling mpg only with am.

```{r, echo = TRUE}
lm1 <- lm(mpg ~ am, data = mtcars)
summary(lm1)
```
The p-value for this linear model is low, hence the coefficient is significant (significantly different from 0).  

However the adjusted R-squared is low. This means that the variation explained by the model is poor. For this reason, other models should be evaluated.

## Linear model based on all the variables

```{r, echo = TRUE}
lmAll <- lm(mpg ~ ., data = mtcars)
summary(lmAll)

# Variance inflation factors
require('car'); vif(lmAll)
```
The variation inflation factors indicate the proportional increase in the variance for each coefficient respect to the case in which the i-th variable is completely independent from the others. The higher the VIF, the higher the redundancy with other variables. VIFs are large for: cyl, disp, wt.

```{r, echo = TRUE}
lm3 <- lm(mpg ~ am + hp + drat + qsec + vs + gear + carb, data = mtcars)
summary(lm3)
```

The variables am, hp, drat, qsec, vs, gear and carb fit a poor model.

```{r, echo = TRUE}

```

```{r, echo = TRUE}

```

```{r, echo = TRUE}

```

# Appendixes

## Appendix A

```{r, echo = TRUE}
str(mtcars)
head(mtcars)
```

## Appendix B

### Transmission

```{r, echo = TRUE, fig.width=5, fig.height=3, fig.align='center'}
qplot(am, mpg, data=mtcars, geom='boxplot', fill=am)
```
